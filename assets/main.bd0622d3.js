let A;async function G(){return A===void 0&&(A=_()),A}async function _(){return m(await WA.room.getTiledMap())}function m(n){const e=new Map;return O(n.layers,"",e),e}function O(n,e,r){for(const t of n)t.type==="group"?O(t.layers,e+t.name+"/",r):(t.name=e+t.name,r.set(t.name,t))}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var F=Object.prototype.toString,C=Array.isArray||function(e){return F.call(e)==="[object Array]"};function L(n){return typeof n=="function"}function $(n){return C(n)?"array":typeof n}function U(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function I(n,e){return n!=null&&typeof n=="object"&&e in n}function B(n,e){return n!=null&&typeof n!="object"&&n.hasOwnProperty&&n.hasOwnProperty(e)}var D=RegExp.prototype.test;function H(n,e){return D.call(n,e)}var K=/\S/;function N(n){return!H(K,n)}var Y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function z(n){return String(n).replace(/[&<>"'`=\/]/g,function(r){return Y[r]})}var J=/\s*/,Q=/\s+/,j=/\s*=/,V=/\s*\}/,X=/#|\^|\/|>|\{|&|=|!/;function Z(n,e){if(!n)return[];var r=!1,t=[],a=[],s=[],l=!1,o=!1,i="",u=0;function h(){if(l&&!o)for(;s.length;)delete a[s.pop()];else s=[];l=!1,o=!1}var d,b,M;function W(g){if(typeof g=="string"&&(g=g.split(Q,2)),!C(g)||g.length!==2)throw new Error("Invalid tags: "+g);d=new RegExp(U(g[0])+"\\s*"),b=new RegExp("\\s*"+U(g[1])),M=new RegExp("\\s*"+U("}"+g[1]))}W(e||v.tags);for(var c=new k(n),w,p,y,x,R,E;!c.eos();){if(w=c.pos,y=c.scanUntil(d),y)for(var P=0,q=y.length;P<q;++P)x=y.charAt(P),N(x)?(s.push(a.length),i+=x):(o=!0,r=!0,i+=" "),a.push(["text",x,w,w+1]),w+=1,x===`
`&&(h(),i="",u=0,r=!1);if(!c.scan(d))break;if(l=!0,p=c.scan(X)||"name",c.scan(J),p==="="?(y=c.scanUntil(j),c.scan(j),c.scanUntil(b)):p==="{"?(y=c.scanUntil(M),c.scan(V),c.scanUntil(b),p="&"):y=c.scanUntil(b),!c.scan(b))throw new Error("Unclosed tag at "+c.pos);if(p==">"?R=[p,y,w,c.pos,i,u,r]:R=[p,y,w,c.pos],u++,a.push(R),p==="#"||p==="^")t.push(R);else if(p==="/"){if(E=t.pop(),!E)throw new Error('Unopened section "'+y+'" at '+w);if(E[1]!==y)throw new Error('Unclosed section "'+E[1]+'" at '+w)}else p==="name"||p==="{"||p==="&"?o=!0:p==="="&&W(y)}if(h(),E=t.pop(),E)throw new Error('Unclosed section "'+E[1]+'" at '+c.pos);return re(ee(a))}function ee(n){for(var e=[],r,t,a=0,s=n.length;a<s;++a)r=n[a],r&&(r[0]==="text"&&t&&t[0]==="text"?(t[1]+=r[1],t[3]=r[3]):(e.push(r),t=r));return e}function re(n){for(var e=[],r=e,t=[],a,s,l=0,o=n.length;l<o;++l)switch(a=n[l],a[0]){case"#":case"^":r.push(a),t.push(a),r=a[4]=[];break;case"/":s=t.pop(),s[5]=a[2],r=t.length>0?t[t.length-1][4]:e;break;default:r.push(a)}return e}function k(n){this.string=n,this.tail=n,this.pos=0}k.prototype.eos=function(){return this.tail===""};k.prototype.scan=function(e){var r=this.tail.match(e);if(!r||r.index!==0)return"";var t=r[0];return this.tail=this.tail.substring(t.length),this.pos+=t.length,t};k.prototype.scanUntil=function(e){var r=this.tail.search(e),t;switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t};function T(n,e){this.view=n,this.cache={".":this.view},this.parent=e}T.prototype.push=function(e){return new T(e,this)};T.prototype.lookup=function(e){var r=this.cache,t;if(r.hasOwnProperty(e))t=r[e];else{for(var a=this,s,l,o,i=!1;a;){if(e.indexOf(".")>0)for(s=a.view,l=e.split("."),o=0;s!=null&&o<l.length;)o===l.length-1&&(i=I(s,l[o])||B(s,l[o])),s=s[l[o++]];else s=a.view[e],i=I(a.view,e);if(i){t=s;break}a=a.parent}r[e]=t}return L(t)&&(t=t.call(this.view)),t};function f(){this.templateCache={_cache:{},set:function(e,r){this._cache[e]=r},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}f.prototype.clearCache=function(){typeof this.templateCache!="undefined"&&this.templateCache.clear()};f.prototype.parse=function(e,r){var t=this.templateCache,a=e+":"+(r||v.tags).join(":"),s=typeof t!="undefined",l=s?t.get(a):void 0;return l==null&&(l=Z(e,r),s&&t.set(a,l)),l};f.prototype.render=function(e,r,t,a){var s=this.getConfigTags(a),l=this.parse(e,s),o=r instanceof T?r:new T(r,void 0);return this.renderTokens(l,o,t,e,a)};f.prototype.renderTokens=function(e,r,t,a,s){for(var l="",o,i,u,h=0,d=e.length;h<d;++h)u=void 0,o=e[h],i=o[0],i==="#"?u=this.renderSection(o,r,t,a,s):i==="^"?u=this.renderInverted(o,r,t,a,s):i===">"?u=this.renderPartial(o,r,t,s):i==="&"?u=this.unescapedValue(o,r):i==="name"?u=this.escapedValue(o,r,s):i==="text"&&(u=this.rawValue(o)),u!==void 0&&(l+=u);return l};f.prototype.renderSection=function(e,r,t,a,s){var l=this,o="",i=r.lookup(e[1]);function u(b){return l.render(b,r,t,s)}if(!!i){if(C(i))for(var h=0,d=i.length;h<d;++h)o+=this.renderTokens(e[4],r.push(i[h]),t,a,s);else if(typeof i=="object"||typeof i=="string"||typeof i=="number")o+=this.renderTokens(e[4],r.push(i),t,a,s);else if(L(i)){if(typeof a!="string")throw new Error("Cannot use higher-order sections without the original template");i=i.call(r.view,a.slice(e[3],e[5]),u),i!=null&&(o+=i)}else o+=this.renderTokens(e[4],r,t,a,s);return o}};f.prototype.renderInverted=function(e,r,t,a,s){var l=r.lookup(e[1]);if(!l||C(l)&&l.length===0)return this.renderTokens(e[4],r,t,a,s)};f.prototype.indentPartial=function(e,r,t){for(var a=r.replace(/[^ \t]/g,""),s=e.split(`
`),l=0;l<s.length;l++)s[l].length&&(l>0||!t)&&(s[l]=a+s[l]);return s.join(`
`)};f.prototype.renderPartial=function(e,r,t,a){if(!!t){var s=this.getConfigTags(a),l=L(t)?t(e[1]):t[e[1]];if(l!=null){var o=e[6],i=e[5],u=e[4],h=l;i==0&&u&&(h=this.indentPartial(l,u,o));var d=this.parse(h,s);return this.renderTokens(d,r,t,h,a)}}};f.prototype.unescapedValue=function(e,r){var t=r.lookup(e[1]);if(t!=null)return t};f.prototype.escapedValue=function(e,r,t){var a=this.getConfigEscape(t)||v.escape,s=r.lookup(e[1]);if(s!=null)return typeof s=="number"&&a===v.escape?String(s):a(s)};f.prototype.rawValue=function(e){return e[1]};f.prototype.getConfigTags=function(e){return C(e)?e:e&&typeof e=="object"?e.tags:void 0};f.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!C(e))return e.escape};var v={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){S.templateCache=n},get templateCache(){return S.templateCache}},S=new f;v.clearCache=function(){return S.clearCache()};v.parse=function(e,r){return S.parse(e,r)};v.render=function(e,r,t,a){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+$(e)+'" was given as the first argument for mustache#render(template, view, partials)');return S.render(e,r,t,a)};v.escape=z;v.Scanner=k;v.Context=T;v.Writer=f;console.log("Script started successfully");console.log(`Problem : 
After a setTiles, the "unset" tile with "null" still here and if you go on the position of a "null" tile you got the event onEnterLayer. 

Actions to reproduce : 
 - First go on blue carpet. You got the console.log onEnterLayer for tile "layerToMove" 
 - Go on the red carpet. The blue carpet are moved 
 - Go on the old position of the blue carpet (tile set to null) and you got the console.log onEnterLayer for tile "layerToMove"`);WA.onInit().then(async()=>{let n=await G();n.forEach((e,r)=>{WA.room.onEnterLayer(r).subscribe(async()=>{if(console.log("onEnterLayer",r,e),r==="move"){const a="layerToMove";let s=n.get(a);console.log(s),s&&(console.log("setTiles"),WA.room.setTiles([{x:5,y:4,tile:"blue",layer:a},{x:6,y:4,tile:"blue",layer:a},{x:7,y:4,tile:"blue",layer:a},{x:5,y:5,tile:"blue",layer:a},{x:6,y:5,tile:"blue",layer:a},{x:7,y:5,tile:"blue",layer:a},{x:5,y:6,tile:"blue",layer:a},{x:6,y:6,tile:"blue",layer:a},{x:7,y:6,tile:"blue",layer:a},{x:1,y:4,tile:null,layer:a},{x:2,y:4,tile:null,layer:a},{x:3,y:4,tile:null,layer:a},{x:1,y:5,tile:null,layer:a},{x:2,y:5,tile:null,layer:a},{x:3,y:5,tile:null,layer:a},{x:1,y:6,tile:null,layer:a},{x:2,y:6,tile:null,layer:a},{x:3,y:6,tile:null,layer:a}]))}})})}).catch(n=>console.error(n));
